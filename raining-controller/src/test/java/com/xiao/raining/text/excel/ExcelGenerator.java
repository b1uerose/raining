package com.xiao.raining.text.excel;

import java.io.FileOutputStream;
import java.io.IOException;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ExcelGenerator {
    public static void main(String[] args) {
        // 创建一个新的工作簿
        try (Workbook workbook = new XSSFWorkbook()) {
            // 创建一个工作表
            Sheet sheet = workbook.createSheet("税收数据");

            // 创建标题行
            Row headerRow = sheet.createRow(0);
            String[] headers = {
                    "年份", "总税利（万元）", "卷烟税利（万元）", "卷烟税利增长率", "单箱增长率",
                    "全州GDP增速", "城镇可支配收入增速", "农村可支配收入增速", "全国单箱（元）",
                    "全国单箱增长率", "全省单箱（元）", "全省单箱增长率", "全州单箱增长率",
                    "地区生产总值（万元）", "第三产业增加值（万元）", "社会消费品零售总额（万元）",
                    "居民食品消费支出（万元）", "CPI指数（居民消费价格指数）"
            };

            for (int i = 0; i < headers.length; i++) {
                Cell cell = headerRow.createCell(i);
                cell.setCellValue(headers[i]);
            }

            // 添加数据行
            double[][] data = {
                    {2011,213913.48,0.098,58422.77,0.3244,0.0665,0.152,0.157,0.213,20929,0.156,23269.0,0.17,0.1546,10001275,2820021,2879371,214953,99.0,19888},
                    {2012,277675.64,0.2981,63517.09,0.0872,0.1137,0.138,0.152,0.159,23287,0.1147,26178.0,0.125,0.1137,11226693,3160070,3471364,259019,101.6,23269},
                    {2013,325768.99,0.1732,70412.64,0.1086,0.0961,0.102,0.094,0.146,24963,0.0725,28246.0,0.079,0.0961,1214022,3383091,3970056,296317,100.4,26178},
                    {2014,389329.03,0.1951,85005.33,0.2072,0.0869,0.085,0.088,0.123,26652,0.067,30458.0,0.073,0.0869,13143033,3676145,4281522,319430,102.2,28246},
                    {2015,431336.69,0.1079,100250.13,0.1793,0.0648,0.09,0.077,0.113,28566,0.0718,31636.0,0.0783,0.0648,13148366,4026120,4972454,381502,101.0,30458},
                    {2016,416384.58,-0.0347,103682.94,0.0342,0.0541,0.06,0.0078,0.1,29166,0.0209,32606,0.0387,0.0541,14039192,4390559,5513824,445662,102.2,31636},
                    {2017,417650.89,0.003,110021.33,0.0611,0.447,0.053,0.085,0.101,30288,0.0385,34138.0,0.0306,0.0447,14809136,5625078,6162785,462561,101.0,32606},
                    {2018,388351.09,-0.0702,114374.96,0.0396,0.0498,0.04,0.08,0.099,31588,0.0428,36068.0,0.0462,0.0498,15331939,6124536,6495777,300559,101.4,34138},
                    {2019,408955.51,0.0531,123034.66,0.0757,0.065,0.073,0.086,0.108,32812,0.0387,37329.0,0.0565,0.065,16762995,7488497,7155001,256857,107.0,36068},
                    {2020,393385.2,-0.0381,135544.29,0.1017,0.0658,0.039,0.048,0.095,33987,0.0358,38945.0,0.035,0.0658,17331465,7668555,6782290,256505,100.5,37329},
            };

            for (int i = 0; i < data.length; i++) {
                Row row = sheet.createRow(i + 1); // 数据行从第2行开始

                for (int j = 0; j < data[i].length; j++) {
                    Cell cell = row.createCell(j);
                    cell.setCellValue(data[i][j]);
                }
            }

            // 保存工作簿到文件
            try (FileOutputStream fileOut = new FileOutputStream("/Users/xiao/Desktop/税收数据.xlsx")) {
                workbook.write(fileOut);
                System.out.println("Excel 文件已创建成功！");
            } catch (IOException e) {
                e.printStackTrace();
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
